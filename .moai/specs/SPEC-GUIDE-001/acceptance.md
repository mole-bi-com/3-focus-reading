# ✅ 인수 기준 - SPEC-GUIDE-001

> **노래방 스타일 읽기 가이드 모드**
>
> 버전: v0.0.1 | 작성일: 2025-10-21 | 작성자: @seungwoolee

---

## 📋 Acceptance Criteria (인수 기준)

이 문서는 SPEC-GUIDE-001 "노래방 스타일 읽기 가이드 모드" 기능이 완료되었다고 판단할 수 있는 구체적인 인수 기준을 정의합니다.

---

## 🎯 시나리오 1: 가이드 모드 활성화

### Given (전제 조건)
- Reading Tablet 애플리케이션이 로드되어 있음
- 포맷팅된 텍스트가 출력창에 표시되어 있음 (최소 3개 이상의 단락)
- 사용자가 가이드 모드를 사용한 적이 없음 (초기 상태)

### When (실행 조건)
1. 사용자가 출력창 상단의 "🎯 가이드 모드" 버튼을 클릭

### Then (기대 결과)
1. **UI 변화**:
   - 가이드 컨트롤 패널이 출력창 상단에 나타남
   - 첫 번째 단락에 하이라이트가 적용됨 (배경색 변경)
   - 나머지 단락은 기본 스타일 유지

2. **초기 설정**:
   - 읽기 속도: 200 WPM (기본값)
   - 자동 진행: OFF
   - 포커스 모드: OFF
   - 진행 상황: "0% (1/N 단락)" 표시

3. **상태 변화**:
   - 가이드 모드 활성화 토스트 메시지 표시
   - 가이드 모드 버튼 상태: ON (시각적 표시)

4. **성공 조건**:
   - ✅ 첫 번째 단락에 `.read-current` 클래스 적용 확인
   - ✅ 가이드 컨트롤 패널 DOM 존재 확인
   - ✅ 초기 WPM 값 = 200 확인
   - ✅ 진행 상황 계산 정확성 확인

---

## 🚀 시나리오 2: 자동 진행 기능

### Given (전제 조건)
- 가이드 모드가 활성화되어 있음
- 현재 위치: 첫 번째 단락
- 읽기 속도: 200 WPM
- 자동 진행: OFF 상태

### When (실행 조건)
1. 사용자가 "▶️ 자동 진행" 버튼을 클릭

### Then (기대 결과)
1. **자동 이동**:
   - 200 WPM에 따라 계산된 시간 후 다음 단락으로 하이라이트 이동
   - 계산식: `시간(초) = (단어 수 / WPM) * 60`
   - 예: 20단어 단락 → 6초 후 이동 (20/200 * 60 = 6)

2. **UI 변화**:
   - 자동 진행 버튼 아이콘: ▶️ → ⏸️ 변경
   - 진행 상황 실시간 업데이트
   - 현재 단락 하이라이트 이동

3. **단락 상태 전환**:
   - 이전 단락: `.read-past` (흐림 - opacity: 0.5)
   - 현재 단락: `.read-current` (강조 - 하이라이트)
   - 다음 단락: `.read-future` (보통 - opacity: 1.0)

4. **마지막 단락 도달**:
   - 자동 진행 자동 정지
   - "읽기 완료!" 토스트 메시지 표시
   - 진행 상황: "100% (N/N 단락)"

5. **성공 조건**:
   - ✅ WPM 기반 타이머 정확도 ±10% 이내
   - ✅ 단락 상태 클래스 정확히 적용
   - ✅ 진행 상황 퍼센트 계산 정확성
   - ✅ 애니메이션 60fps 유지 (Chrome DevTools 측정)

---

## ⏸️ 시나리오 3: 일시정지 및 재개

### Given (전제 조건)
- 가이드 모드 활성화
- 자동 진행 모드 실행 중
- 현재 위치: 3번째 단락

### When (실행 조건)
1. 사용자가 스페이스바를 누름

### Then (기대 결과)
1. **일시정지**:
   - 자동 진행 타이머 정지
   - 현재 단락에서 하이라이트 고정
   - 버튼 아이콘: ⏸️ → ▶️ 변경
   - 토스트 메시지: "일시정지됨"

2. **재개** (스페이스바 다시 누름):
   - 자동 진행 타이머 재시작
   - 남은 시간부터 계속 진행
   - 버튼 아이콘: ▶️ → ⏸️ 변경
   - 토스트 메시지: "재개됨"

3. **성공 조건**:
   - ✅ 일시정지 시 타이머 완전 정지 확인
   - ✅ 재개 시 남은 시간 계산 정확성
   - ✅ 키보드 이벤트 정상 동작

---

## 🎨 시나리오 4: 포커스 모드

### Given (전제 조건)
- 가이드 모드 활성화
- 현재 위치: 5번째 단락 (총 10개 단락)
- 포커스 모드: OFF

### When (실행 조건)
1. 사용자가 "👁️ 포커스" 토글 버튼을 클릭

### Then (기대 결과)
1. **시각적 효과**:
   - 현재 단락 (5번째): 선명 유지 (opacity: 1.0, filter: none)
   - 이전 단락 (1~4번째): 블러 + 반투명 (opacity: 0.3, filter: blur(2px))
   - 다음 단락 (6~10번째): 블러 + 반투명 (opacity: 0.3, filter: blur(2px))

2. **UI 상태**:
   - 포커스 토글 버튼 활성 상태 표시 (배경색 변경)
   - 설정 LocalStorage에 저장

3. **단락 이동 시**:
   - 새로운 현재 단락만 선명하게
   - 나머지는 블러 처리 유지
   - 애니메이션 부드럽게 전환 (transition: 0.3s)

4. **포커스 모드 해제** (토글 다시 클릭):
   - 모든 블러 효과 제거
   - 기본 상태로 복원

5. **성공 조건**:
   - ✅ CSS 필터 정확히 적용 (`filter: blur(2px)`)
   - ✅ 현재 단락만 선명하게 유지
   - ✅ 애니메이션 부드러움 (60fps)
   - ✅ LocalStorage 저장 확인

---

## ⌨️ 시나리오 5: 키보드 단축키

### Given (전제 조건)
- 가이드 모드 활성화
- 현재 위치: 3번째 단락 (총 10개 단락)
- 읽기 속도: 200 WPM
- 포커스가 입력 필드(input, textarea)에 없음

### When (실행 조건)
사용자가 다양한 키보드 단축키를 사용

### Then (기대 결과)

#### 5-1. 단락 이동 (↑/↓)
- **↓ (아래 화살표)**: 다음 단락으로 이동 (3 → 4)
- **↑ (위 화살표)**: 이전 단락으로 이동 (4 → 3)
- **마지막 단락에서 ↓**: 변화 없음, 경고 메시지 표시
- **첫 단락에서 ↑**: 변화 없음

#### 5-2. 속도 조절 (+/-)
- **+ (더하기)**: WPM +10 (200 → 210)
- **- (빼기)**: WPM -10 (200 → 190)
- **최대값 도달 (500)**: WPM 고정, "최대 속도입니다" 메시지
- **최소값 도달 (50)**: WPM 고정, "최소 속도입니다" 메시지

#### 5-3. 기타 단축키
- **G**: 가이드 모드 ON/OFF 토글
- **F**: 포커스 모드 ON/OFF 토글
- **R**: 첫 번째 단락으로 돌아가기
- **Esc**: 가이드 모드 종료

#### 5-4. 입력 필드 내에서
- **모든 단축키**: 동작하지 않음 (기본 입력 기능 유지)

5. **성공 조건**:
   - ✅ 모든 단축키 정상 동작
   - ✅ 입력 필드에서 단축키 비활성화
   - ✅ 범위 검증 (50~500 WPM)
   - ✅ 적절한 피드백 메시지 표시

---

## 💾 시나리오 6: 설정 저장 및 복원

### Given (전제 조건)
- 가이드 모드 활성화
- 사용자가 다음 설정을 변경:
  - 읽기 속도: 250 WPM
  - 포커스 모드: ON
  - 현재 위치: 7번째 단락
  - 하이라이트 색상: #FF5733 (커스텀)

### When (실행 조건)
1. 사용자가 페이지를 새로고침 (F5)
2. 또는 브라우저를 닫았다가 다시 방문

### Then (기대 결과)
1. **설정 복원**:
   - 읽기 속도: 250 WPM (저장된 값)
   - 포커스 모드: ON 상태 유지
   - 하이라이트 색상: #FF5733 적용

2. **위치 복원**:
   - 7번째 단락으로 자동 스크롤
   - 7번째 단락에 하이라이트 적용
   - 진행 상황: "60% (7/10 단락)" 표시

3. **LocalStorage 데이터**:
   ```json
   {
     "reading-guide-settings": {
       "enabled": true,
       "wpm": 250,
       "focusMode": true,
       "highlightColor": "#FF5733",
       "lastPosition": 6,
       "timestamp": 1698765432000
     }
   }
   ```

4. **오류 처리**:
   - LocalStorage 없음: 기본 설정 사용
   - 데이터 손상: 기본 설정으로 리셋, 경고 메시지

5. **성공 조건**:
   - ✅ 모든 설정 정확히 복원
   - ✅ 저장 위치로 자동 이동
   - ✅ LocalStorage 데이터 구조 검증
   - ✅ 오류 시 기본 설정 폴백

---

## 📊 시나리오 7: 진행 상황 표시

### Given (전제 조건)
- 가이드 모드 활성화
- 총 단락 수: 20개
- 현재 위치: 10번째 단락

### When (실행 조건)
1. 사용자가 자동 진행 또는 수동으로 단락 이동

### Then (기대 결과)
1. **진행 상황 계산**:
   - 퍼센트: 50% (10/20 * 100)
   - 표시 형식: "50% (10/20 단락)"

2. **프로그레스 바**:
   - 시각적 진행 상황 표시
   - 50% 지점까지 색상 채워짐
   - 애니메이션 부드럽게 진행

3. **특수 상황**:
   - **시작** (1/20): "5% (1/20 단락)"
   - **완료** (20/20): "100% (20/20 단락)"
   - **빈 텍스트**: "0% (0/0 단락)" + 가이드 모드 비활성화

4. **성공 조건**:
   - ✅ 퍼센트 계산 정확성 (소수점 첫째 자리 반올림)
   - ✅ 실시간 업데이트
   - ✅ 프로그레스 바 시각적 동기화

---

## 🎭 시나리오 8: 하이라이트 커스터마이징

### Given (전제 조건)
- 가이드 모드 활성화
- 기본 하이라이트 색상: #4361ee (파란색)

### When (실행 조건)
1. 사용자가 설정(⚙️) 버튼을 클릭
2. 색상 선택 팔레트에서 #06d6a0 (초록색) 선택

### Then (기대 결과)
1. **색상 변경**:
   - 현재 단락 배경색: #06d6a0으로 즉시 변경
   - CSS Variable 업데이트: `--guide-highlight-color`

2. **설정 저장**:
   - LocalStorage에 색상 값 저장
   - 다음 방문 시 초록색 유지

3. **프리셋 색상**:
   - 파란색 (#4361ee)
   - 초록색 (#06d6a0)
   - 주황색 (#ff9f1c)
   - 보라색 (#9d4edd)
   - 커스텀 (Color Picker)

4. **성공 조건**:
   - ✅ 색상 즉시 적용
   - ✅ LocalStorage 저장
   - ✅ 접근성: 대비율 4.5:1 이상 보장

---

## 🚨 시나리오 9: 오류 처리

### 9-1. 빈 텍스트 오류

**Given**: 출력창에 텍스트가 없음
**When**: "가이드 모드" 버튼 클릭
**Then**:
- 가이드 모드 활성화 차단
- 오류 토스트 메시지: "포맷팅된 텍스트가 없습니다"
- 가이드 모드 버튼 비활성화 상태 유지

### 9-2. LocalStorage 용량 초과

**Given**: LocalStorage 용량이 거의 가득 참
**When**: 설정 저장 시도
**Then**:
- 저장 실패
- 경고 메시지: "설정 저장 실패. 기본 설정을 사용합니다."
- 기본 설정으로 동작 (200 WPM, 포커스 OFF)

### 9-3. 브라우저 미지원 (Intersection Observer)

**Given**: 구형 브라우저 (Intersection Observer 미지원)
**When**: 가이드 모드 활성화
**Then**:
- 폴백 메커니즘 사용 (`querySelector` 기반)
- 경고 메시지: "일부 기능이 제한될 수 있습니다"
- 기본 기능은 정상 동작

---

## ⚡ 시나리오 10: 성능 테스트

### 10-1. 대용량 텍스트 (1000개 단락)

**Given**: 1000개 단락의 긴 텍스트
**When**: 가이드 모드 활성화 및 자동 진행
**Then**:
- 애니메이션 60fps 유지
- 응답 시간 <100ms
- 메모리 사용량 증가 <10MB
- 스크롤 부드러움 유지

### 10-2. 빠른 단락 이동 (연속 키 입력)

**Given**: 가이드 모드 활성화
**When**: ↓ 키를 빠르게 20번 연속 누름
**Then**:
- 모든 키 입력 정확히 처리
- 단락 상태 정확히 업데이트
- UI 지연 없음
- 메모리 누수 없음

---

## 📱 시나리오 11: 반응형 및 모바일

### 11-1. 태블릿 (768px ~ 1024px)

**Given**: 태블릿 화면 크기
**When**: 가이드 모드 활성화
**Then**:
- 컨트롤 패널 레이아웃 조정 (세로 정렬)
- 터치 제스처 지원:
  - 스와이프 위: 이전 단락
  - 스와이프 아래: 다음 단락
- 모든 기능 정상 동작

### 11-2. 모바일 (< 768px)

**Given**: 모바일 화면 크기
**When**: 가이드 모드 활성화
**Then**:
- 간소화된 컨트롤 (필수 기능만)
- 큰 터치 영역 (최소 44x44px)
- 진행 상황 표시 간략화
- 포커스 모드 자동 ON (화면 작음)

---

## ✅ 전체 인수 기준 체크리스트

### 기능 요구사항
- [ ] 가이드 모드 ON/OFF 정상 동작
- [ ] Progressive Line Highlighting 정확히 적용
- [ ] 자동 진행 WPM 기반 정확도 ±10%
- [ ] 포커스 모드 블러 효과 적용
- [ ] 키보드 단축키 7개 모두 동작
- [ ] 설정 저장 및 복원 정상 동작
- [ ] 진행 상황 계산 정확성
- [ ] 하이라이트 색상 커스터마이징

### 성능 요구사항
- [ ] 애니메이션 60fps 유지 (Chrome DevTools)
- [ ] 버튼 응답 시간 <100ms
- [ ] 메모리 사용량 증가 <10MB
- [ ] 초기 로딩 <200ms
- [ ] LocalStorage 용량 <5KB

### 접근성 요구사항
- [ ] ARIA 레이블 모든 버튼 적용
- [ ] 키보드 네비게이션 전체 기능
- [ ] 스크린 리더 상태 변화 안내
- [ ] 고대비 모드 지원
- [ ] Focus Indicator 시각적 표시

### 품질 요구사항
- [ ] 단위 테스트 커버리지 ≥85%
- [ ] 통합 테스트 11개 시나리오 모두 통과
- [ ] 오류 처리 시나리오 3개 검증
- [ ] 성능 테스트 2개 통과
- [ ] 반응형 테스트 (데스크톱/태블릿/모바일)

### 문서화
- [ ] README 업데이트 (기능 소개)
- [ ] 사용 가이드 작성
- [ ] API 문서 작성
- [ ] 키보드 단축키 목록
- [ ] 트러블슈팅 가이드

### 코드 품질
- [ ] ESLint 검사 통과 (에러 0개)
- [ ] JSDoc 주석 추가 (public 메서드)
- [ ] @TAG 체인 검증 (@SPEC, @TEST, @CODE)
- [ ] TRUST 5원칙 준수 확인
- [ ] 코드 리뷰 완료

---

## 🎯 최종 승인 기준

다음 조건이 **모두** 충족되었을 때 SPEC-GUIDE-001이 완료된 것으로 간주합니다:

1. ✅ 위의 11개 시나리오가 **모두** 통과
2. ✅ 성능 목표 **모두** 달성
3. ✅ 접근성 WCAG 2.1 AA 준수
4. ✅ 단위 테스트 커버리지 ≥85%
5. ✅ 코드 리뷰 승인
6. ✅ 문서화 완료
7. ✅ TRUST 5원칙 검증 완료

---

**작성자**: @seungwoolee | **날짜**: 2025-10-21 | **버전**: v0.0.1
